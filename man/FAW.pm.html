<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Dancer::Plugin::FAW - Form Advanced Way</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:root@localhost" />
</head>

<body style="background-color: white">


<!-- INDEX BEGIN -->
<div name="index">
<p><a name="__index__"></a></p>

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#version">VERSION</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<ul>

		<li><a href="#fawconvertpath">fawConvertPath</a></li>
		<li><a href="#fawform">fawform</a></li>
	</ul>

</ul>

<hr name="index" />
</div>
<!-- INDEX END -->

<p>
</p>
<hr />
<h1><a name="name">NAME</a></h1>
<p>Dancer::Plugin::FAW - Form Advanced Way</p>
<p>
</p>
<hr />
<h1><a name="version">VERSION</a></h1>
<p>0.2</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<p>После подключения модуля мы можем декларировать формы в описательном виде в
коде программы. Преимущество подхода: возможность быстрого переопределения
полей формы, логики работы с полями, проверок полей и отображения полей в БД
в одном месте.</p>
<p>Декларируйте описание новой формы</p>
<pre>
    fawform '/callback' =&gt; {
        title       =&gt; '',
        formname    =&gt; '',
        template    =&gt; 'callback-form',
        layout      =&gt; '',
        redirect    =&gt; '',
        fields      =&gt; [ 
            { ... },
        ],
        buttons     =&gt; [
            { ... },
        ],
        before      =&gt; sub {
            ...
        },
        after       =&gt; sub {
            ...
        },
    };</pre>
<p>Опишите форму с помощью общих полей: укажите её заголовок (title); задайте
название формы в теге FORM с помощью поля formname; используйте при
необходимости свой собственный шаблон, отличный от основного с помощью
параметра template; применяйте частный макет вывода с помощью параметра layout;
установите общую точку перехода в поле redirect.</p>
<p>Расширьте поля формы в разделе fields и кнопки формы в разделе buttons, как это
описано в FAW::Forms.</p>
<p>Если это необходимо, определите логику работы формы перед её отрисовкой
(before): здесь можно управлять правами, реализовывать подстановку дефолтных значений 
в поля формы.</p>
<p>Определите логику работы формы после отправки данных (after): куда и каким образом
будут помещены данные; куда будет совершён переход (если он отличается от
заданного в поле redirect в зависимости от условий формы); какие дополнительные
действия должна выполнить логика в том или ином случае.</p>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p>Модуль для продвинутого описания форм. Склеивает FAW::Forms и Dancer с
удобными дополнениями.</p>
<p>
</p>
<h2><a name="fawconvertpath">fawConvertPath</a></h2>
<p>Dancer может использовать поледержатели в качестве части пути. При работе с
формой нам следует заменить поледержатель его значением, иначе работа с формой
будет некорректна.</p>
<p>
</p>
<h2><a name="fawform">fawform</a></h2>
<p>Через описание формы передаётся ряд дополнительных параметров для fawform:</p>
<pre>

- template = шаблон, использующийся для вывода формы. Отрисовка формы ведётся
через этот шаблон;</pre>
<p>- redirect = на какую страничку перейти в случае принятия данных формы.</p>
<p>Перенаправление можно указать явно в хэше $faw или в хэше config или не
указывать, и перейти к корневой точке (путь &quot;/&quot; = индексная страничка).</p>
<p>Для начала нам следует сопоставить полученные на предыдущем этапе данные в поля
формы - вдруг, мы передумаем переходить куда-либо, и потребуем у пользователя
поправить себя.</p>
<p>Затем нам следует выполнить валидацию данных пользователя, основываясь на
правилах секции validate описания формы и используя модуль validate.</p>
<p>И только после этого мы можем вызвать предопределённое действие before POST
(если, конечно, оно было предопределено).</p>
<p>... и мы должны вернуться к форме, отрисовать её и сообщить об этой ошибке.</p>
<p>То есть, мы рендерим шаблон и возвращаемся к нормальной (штатной) работе с
формой.</p>
<p>Со стороны разработчика в наиболее типичном случае остаётся 
воспользоваться модулем следующим образом:</p>
<p>- определить поля формы согласно FAW::Form и FAW::Elements;</p>
<p>- определить кнопки формы согласно FAW::Form и FAW::Elements;</p>
<p>- описать правило before GET при вхождении в форму (сопоставление имеющихся
данных и полей формы);</p>
<p>- описать правило before POST для выхода из формы (сохранение данных или
дополнительные действия с обязательным подтверждением успешности);</p>

</body>

</html>
